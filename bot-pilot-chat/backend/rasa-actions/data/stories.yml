version: '3.1'
stories:

  - story: user makes three mistakes and denies
    steps:
      - intent: termin_vereinbaren
      - action: termin_form
      - active_loop: termin_form
      - slot_was_set:
          - requested_slot: termin_medium
      - intent: nlu_fallback
      - slot_was_set:
          - termin_medium_attempts: 3
      - action: action_ask_continue
      - intent: deny
      - active_loop: null

  - story: user makes three mistakes and affirms
    steps:
      - intent: termin_vereinbaren
      - action: termin_form
      - active_loop: termin_form
      - slot_was_set:
          - requested_slot: termin_medium
      - intent: nlu_fallback
      - slot_was_set:
          - termin_medium_attempts: 3
      - action: action_ask_continue
      - intent: affirm
      - action: termin_form
      - active_loop: termin_form

  - story: happy path collect termin_medium and termin_type
    steps:
      - intent: termin_vereinbaren
      - action: termin_form
      - active_loop: termin_form
      - slot_was_set:
          - requested_slot: termin_medium
      - intent: termin_medium_inform
      - action: termin_form
      - slot_was_set:
          - requested_slot: termin_type
      - intent: termin_type_inform
      - slot_was_set:
          - requested_slot: null
      - action: termin_form
      - active_loop: null
      - action: action_switch_form

  - story: happy path switch to user_type_form
    steps:
      - active_loop: termin_form
      - slot_was_set:
          - requested_slot: null
      - action: termin_form
      - active_loop: null
      - action: action_switch_form
      - slot_was_set:
          - next_form_name: user_type_form
      - action: user_type_form
      - active_loop: user_type_form

  - story: happy path collect user_type and switch to user info form
    steps:
      - action: user_type_form
      - active_loop: user_type_form
      - slot_was_set:
          - requested_slot: user_type
      - intent: user_type_inform
      - slot_was_set:
          - requested_slot: null
      - action: user_type_form
      - active_loop: null
      - action: action_switch_form
      - slot_was_set:
          - next_form_name: user_info_form
      - action: user_info_form
      - active_loop: user_info_form

  - story: happy path collect user_name
    steps:
      - action: user_info_form
      - active_loop: user_info_form
      - slot_was_set:
          - requested_slot: user_name
      - intent: user_name_inform
      - action: user_info_form
      - intent: affirm
      - action: action_handle_user_name_confirm
      - slot_was_set:
          - requested_slot: user_mail
      - action: user_info_form

  - story: happy path collect user_mail
    steps:
      - action: user_info_form
      - active_loop: user_info_form
      - slot_was_set:
          - requested_slot: user_mail
      - intent: user_mail_inform
      - action: user_info_form
      - slot_was_set:
          - requested_slot: null


  - story: happy path collect consultant_name
    steps:
      - action: consultant_form
      - active_loop: consultant_form
      - slot_was_set:
          - requested_slot: consultant_name
      - action: action_ask_consultant
      - intent: consultant_inform
      - action: consultant_form
      - slot_was_set:
          - requested_slot: null
      - active_loop: null

  - story: happy path switch to consultant_form
    steps:
      - action: action_switch_form
      - slot_was_set:
          - next_form_name: consultant_form
      - action: consultant_form
      - active_loop: consultant_form

  - story: collect user_name and name confirmed directly
    steps:
      - action: user_info_form
      - active_loop: user_info_form
      - slot_was_set:
          - requested_slot: user_name
      - intent: user_name_inform
      - action: user_info_form
      - intent: affirm
      - action: action_handle_user_name_confirm
      - action: user_info_form

  - story: collect user_name and name was denied in first step
    steps:
      - action: user_info_form
      - active_loop: user_info_form
      - slot_was_set:
          - requested_slot: user_name
      - intent: user_name_inform
      - action: user_info_form
      - intent: deny
      - action: action_handle_user_name_confirm
      - action: user_info_form

